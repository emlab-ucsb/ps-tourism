labs(x ="Average user fee per dive \n(US$)", y = "\u0394 # dives \n(million)")+
plot_theme
# Combine into final plot
fig_4_no_leg <- cowplot::plot_grid(fig_4_a + theme(legend.position = "none"),
fig_4_b + theme(legend.position = "none"),
fig_4_c + theme(legend.position = "none"),
fig_4_d + theme(legend.position = "none"),
ncol = 2,
labels = c("A)", "B)", "C)", "D)"),
rel_heights=c(1,1))
fig_4 <- plot_grid(fig_4_no_leg,
get_legend(fig_4_a +
theme(legend.margin = margin(t = 0.25, unit='cm'))),
ncol = 1,
rel_heights = c(5, 1))
fig_4
ggsave(here("figures","main","plot_explore_user_fee.jpg"),fig_4, width = 6.5, height = 6, units = "in")
fig_4 <- plot_grid(fig_4_no_leg,
get_legend(fig_4_a +
theme(legend.margin = margin(t = 0.25, unit='cm'))),
ncol = 1,
rel_heights = c(6, 1))
fig_4
ggsave(here("figures","main","plot_explore_user_fee.jpg"),fig_4, width = 6.5, height = 6, units = "in")
fig_4_no_leg <- cowplot::plot_grid(fig_4_a + theme(legend.position = "none"),
fig_4_b + theme(legend.position = "none"),
fig_4_c + theme(legend.position = "none"),
fig_4_d + theme(legend.position = "none"),
ncol = 2,
labels = c("A)", "B)", "C)", "D)"),
label_y = 1.1,
rel_heights=c(1,1))
fig_4 <- plot_grid(fig_4_no_leg,
get_legend(fig_4_a +
theme(legend.margin = margin(t = 0.25, unit='cm'))),
ncol = 1,
rel_heights = c(6, 1))
fig_4
ggsave(here("figures","main","plot_explore_user_fee.jpg"),fig_4, width = 6.5, height = 6, units = "in")
fig_4_no_leg <- cowplot::plot_grid(fig_4_a + theme(legend.position = "none"),
fig_4_b + theme(legend.position = "none"),
fig_4_c + theme(legend.position = "none"),
fig_4_d + theme(legend.position = "none"),
ncol = 2,
labels = c("A)", "B)", "C)", "D)"),
rel_heights=c(1,1))
fig_4 <- plot_grid(fig_4_no_leg,
get_legend(fig_4_a +
theme(legend.margin = margin(t = 0.25, unit='cm'))),
ncol = 1,
rel_heights = c(6, 1))
fig_4
ggsave(here("figures","main","plot_explore_user_fee.jpg"),fig_4, width = 6.5, height = 6, units = "in")
explore_user_fee_merged[1,]
component_effect_name <- round(effect_name/average_user_fee,4)
component_biomass_effect <- round(mean(effect_biomass)/average_user_fee,4)
component_biodiversity_effect <- round(mean(effect_biodiversity)/average_user_fee,4)
component_effect_name <- round(effect_name/average_user_fee,4)
component_biomass_effect <- round(mean(effect_biomass)/average_user_fee,4)
component_biodiversity_effect <- round(mean(effect_biodiversity)/average_user_fee,4)
effect_name
average_user_fee
effect_biomass
fig_3_a <- data.frame(value = c(component_effect_name, component_biomass_effect, component_biodiversity_effect),
Component = c("MPA name","Biomass","Biodiversity")) %>%
ggplot(aes(x = "", y = value, fill = Component)) +
geom_col(color = "black") +
geom_text(aes(label = percent(value)),
position = position_stack(vjust = 0.5)) +
coord_polar(theta = "y") +
#scale_fill_brewer() +
ggtitle("Drivers of MPA benefits")+
theme_void()+
theme(plot.title = element_text(hjust = 0.5))
fig_3_a
fig_3_a <- data.frame(value = c(component_effect_name, component_biomass_effect, component_biodiversity_effect),
Component = c("MPA name","Biomass","Biodiversity")) %>%
ggplot(aes(x = "", y = value, fill = Component)) +
geom_col(color = "black") +
geom_text(aes(label = paste0(percent(value), "\n", Component)),
position = position_stack(vjust = 0.5)) +
coord_polar(theta = "y") +
#scale_fill_brewer() +
ggtitle("Drivers of Total MPA benefits")+
theme_void()+
theme(plot.title = element_text(hjust = 0.5))
fig_3_a
fig_3_a <- data.frame(value = c(component_effect_name, component_biomass_effect, component_biodiversity_effect),
Component = c("MPA name effect","Biomass effect","Biodiversity effect")) %>%
ggplot(aes(x = "", y = value, fill = Component)) +
geom_col(color = "black") +
geom_text(aes(label = paste0(percent(value), "\n", Component)),
position = position_stack(vjust = 0.5)) +
coord_polar(theta = "y") +
#scale_fill_brewer() +
ggtitle("Drivers of Total MPA benefits")+
theme_void()+
theme(plot.title = element_text(hjust = 0.5))
p1_contribution #ok, this is the contribution of different components
fig_3_a <- data.frame(value = c(component_effect_name, component_biomass_effect, component_biodiversity_effect),
Component = c("MPA name effect","Biomass effect","Biodiversity effect")) %>%
ggplot(aes(x = "", y = value, fill = Component)) +
geom_col(color = "black") +
geom_text(aes(label = paste0(percent(value), "\n", Component)),
position = position_stack(vjust = 0.5)) +
coord_polar(theta = "y") +
#scale_fill_brewer() +
ggtitle("Drivers of Total MPA benefits")+
theme_void()+
theme(plot.title = element_text(hjust = 0.5))
fig_3_a  #ok, this is the contribution of different components
fig_3_a <- data.frame(value = c(component_effect_name, component_biomass_effect, component_biodiversity_effect),
Component = c("MPA name effect","Biomass effect","Biodiversity effect")) %>%
ggplot(aes(x = "", y = value, fill = Component)) +
geom_col(color = "black") +
geom_text(aes(label = paste0(percent(value), "\n", Component)),
position = position_stack(vjust = 1)) +
coord_polar(theta = "y") +
#scale_fill_brewer() +
ggtitle("Drivers of Total MPA benefits")+
theme_void()+
theme(plot.title = element_text(hjust = 0.5))
fig_3_a
fig_3_a <- data.frame(value = c(component_effect_name, component_biomass_effect, component_biodiversity_effect),
Component = c("MPA name effect","Biomass effect","Biodiversity effect")) %>%
ggplot(aes(x = "", y = value, fill = Component)) +
geom_col(color = "black") +
geom_text(aes(label = paste0(percent(value), "\n", Component)),
position = position_stack(vjust = 0.5, hjust = 0.5)) +
coord_polar(theta = "y") +
#scale_fill_brewer() +
ggtitle("Drivers of Total MPA benefits")+
theme_void()+
theme(plot.title = element_text(hjust = 0.5))
fig_3_a <- data.frame(value = c(component_effect_name, component_biomass_effect, component_biodiversity_effect),
Component = c("MPA name effect","Biomass effect","Biodiversity effect")) %>%
ggplot(aes(x = "", y = value, fill = Component)) +
geom_col(color = "black") +
geom_text(aes(label = paste0(percent(value), "\n", Component)),
position = position_stack(vjust = 0.5)) +
coord_polar(theta = "y") +
#scale_fill_brewer() +
ggtitle("Drivers of Total MPA benefits")+
theme_void()+
theme(plot.title = element_text(hjust = 0.5))
fig_3_a
fig_3_a <- data.frame(value = c(component_effect_name, component_biomass_effect, component_biodiversity_effect),
Component = c("MPA name effect","Biomass effect","Biodiversity effect")) %>%
ggplot(aes(x = "", y = value, fill = Component)) +
geom_col(color = "black") +
geom_text(aes(label = paste0(percent(value), "\n", Component)),
position = position_stack(vjust = 0.5)) +
coord_polar(theta = "y") +
#scale_fill_brewer() +
ggtitle("Drivers of global MPA benefits")+
theme_void()+
theme(plot.title = element_text(hjust = 0.5))
fig_3_a
pie_theme <- theme_void()+
theme(plot.title = element_text(hjust = 0.5))
#with MPA, then user fee of 13 USD per dive (to be exact, check the average user fee)
component_effect_name <- round(effect_name/average_user_fee,4)
component_biomass_effect <- round(mean(effect_biomass)/average_user_fee,4)
component_biodiversity_effect <- round(mean(effect_biodiversity)/average_user_fee,4)
fig_3_a <- data.frame(value = c(component_effect_name, component_biomass_effect, component_biodiversity_effect),
Component = c("MPA name effect","Biomass effect","Biodiversity effect")) %>%
ggplot(aes(x = "", y = value, fill = Component)) +
geom_col(color = "black") +
geom_text(aes(label = paste0(percent(value), "\n", Component)),
position = position_stack(vjust = 0.5)) +
coord_polar(theta = "y") +
ggtitle("Drivers of global MPA benefits")+
pie_theme
fig_3_a
pie_theme <- theme_void()+
theme(plot.title = element_text(hjust = 0.5),
legend.position = "none")
pie_theme
fig_3_a
fig_3_a <- data.frame(value = c(component_effect_name, component_biomass_effect, component_biodiversity_effect),
Component = c("MPA name effect","Biomass effect","Biodiversity effect")) %>%
ggplot(aes(x = "", y = value, fill = Component)) +
geom_col(color = "black") +
geom_text(aes(label = paste0(percent(value), "\n", Component)),
position = position_stack(vjust = 0.5)) +
coord_polar(theta = "y") +
ggtitle("Drivers of global MPA benefits")+
pie_theme
fig_3_a
pie_dat <- data.frame(value = c(component_effect_name, component_biomass_effect, component_biodiversity_effect),
Component = c("MPA name effect","Biomass effect","Biodiversity effect")) %>%
mutate(csum = rev(cumsum(rev(value))),
pos = value/2 + lead(csum, 1),
pos = if_else(is.na(pos), value/2, pos))
pie_dat <- data.frame(value = c(component_effect_name, component_biomass_effect, component_biodiversity_effect),
Component = c("MPA name effect","Biomass effect","Biodiversity effect")) %>%
mutate(csum = rev(cumsum(rev(value))),
pos = value/2 + lead(csum, 1),
pos = if_else(is.na(pos), value/2, pos))
fig_3_a <- ggplot(pie_dat , aes(x = "", y = value, fill = Component)) +
geom_col(color = "black") +
coord_polar(theta = "y") +
ggtitle("Drivers of global MPA benefits")+
geom_text(aes(label = percent(value)),
position = position_stack(vjust = 0.5)) +
pie_theme
fig_3_a
fig_3_a <- ggplot(pie_dat , aes(x = "", y = value, fill = Component)) +
geom_col(color = "black") +
coord_polar(theta = "y") +
ggtitle("Drivers of global MPA benefits")+
geom_text(aes(label = percent(value)),
position = position_stack(vjust = 0.8)) +
pie_theme
fig_3_a
fig_3_a <- ggplot(pie_dat , aes(x = "", y = value, fill = Component)) +
geom_col(color = "black") +
coord_polar(theta = "y") +
ggtitle("Drivers of global MPA benefits")+
geom_text(aes(label = percent(value)),
position = position_stack(vjust = 0.5)) +
scale_y_continuous(breaks = pie_dat$pos, labels = pie_dat$Component) +
pie_theme
fig_3_a
pie_theme <- theme(axis.ticks = element_blank(),
axis.title = element_blank(),
axis.text = element_text(size = 15),
legend.position = "none", # Removes the legend
panel.background = element_rect(fill = "white"),
plot.title = element_text(hjust = 0.5))
pie_dat <- data.frame(value = c(component_effect_name, component_biomass_effect, component_biodiversity_effect),
Component = c("MPA name effect","Biomass effect","Biodiversity effect")) %>%
mutate(csum = rev(cumsum(rev(value))),
pos = value/2 + lead(csum, 1),
pos = if_else(is.na(pos), value/2, pos))
fig_3_a <- ggplot(pie_dat , aes(x = "", y = value, fill = Component)) +
geom_col(color = "black") +
coord_polar(theta = "y") +
ggtitle("Drivers of global MPA benefits")+
geom_text(aes(label = percent(value)),
position = position_stack(vjust = 0.5)) +
scale_y_continuous(breaks = pie_dat$pos, labels = pie_dat$Component) +
pie_theme
fig_3_a  #ok, this is the contrib
install.packages("ggrepel")
install.packages("ggrepel")
fig_3_a <- ggplot(pie_dat , aes(x = "", y = value, fill = Component)) +
geom_col(color = "black") +
coord_polar(theta = "y") +
ggtitle("Drivers of global MPA benefits")+
geom_label_repel(data = pie_dat,
aes(y = pos, label = paste0(Component, "\n", value, "%")),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
pie_theme
fig_3_a  #
fig_3_a <- ggplot(pie_dat , aes(x = "", y = value, fill = fct_inorder(Component))) +
geom_col(color = "black") +
coord_polar(theta = "y") +
ggtitle("Drivers of global MPA benefits")+
geom_label_repel(data = pie_dat,
aes(y = pos, label = paste0(Component, "\n", value, "%")),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
pie_theme
fig_3_a
fig_3_a <- ggplot(pie_dat , aes(x = "", y = value, fill = fct_inorder(Component))) +
geom_col(color = "black") +
coord_polar(theta = "y") +
ggtitle("Drivers of global MPA benefits")+
geom_label_repel(data = pie_dat,
aes(y = pos, label = paste0(Component, "\n", percent(value))),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
pie_theme
fig_3_a
pie_theme <- theme_void()+
theme(legend.position = "none", # Removes the legend
plot.title = element_text(hjust = 0.5))
pie_dat <- data.frame(value = c(component_effect_name, component_biomass_effect, component_biodiversity_effect),
Component = c("MPA name effect","Biomass effect","Biodiversity effect")) %>%
mutate(csum = rev(cumsum(rev(value))),
pos = value/2 + lead(csum, 1),
pos = if_else(is.na(pos), value/2, pos))
fig_3_a <- ggplot(pie_dat , aes(x = "", y = value, fill = fct_inorder(Component))) +
geom_col(color = "black") +
coord_polar(theta = "y") +
ggtitle("Drivers of global MPA benefits")+
geom_label_repel(data = pie_dat,
aes(y = pos, label = paste0(Component, "\n", percent(value))),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
pie_theme
fig_3_a  #ok, this is the con
fig_3_a <- ggplot(pie_dat , aes(x = "", y = value, fill = fct_inorder(Component))) +
geom_col(color = "black") +
coord_polar(theta = "y") +
ggtitle("Drivers of global MPA benefits")+
geom_label_repel(data = pie_dat,
aes(y = pos, label = paste0(Component, "\n", percent(value))),
size = 4.5, nudge_x = 0, show.legend = FALSE) +
pie_theme
fig_3_a
fig_3_a <- ggplot(pie_dat , aes(x = "", y = value, fill = fct_inorder(Component))) +
geom_col(color = "black") +
coord_polar(theta = "y") +
ggtitle("Drivers of global MPA benefits")+
geom_label_repel(data = pie_dat,
aes(y = pos, label = paste0(Component, "\n", percent(value))),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
pie_theme
fig_3_a
fig_3_a <- ggplot(pie_dat , aes(x = "", y = value, fill = fct_inorder(Component))) +
geom_col(color = "black") +
coord_polar(theta = "y") +
ggtitle("Drivers of global MPA benefits")+
geom_label_repel(data = pie_dat,
aes(y = pos, label = paste0(Component, "\n", percent(value))),
size = 4.5, nudge_x = 1.1, show.legend = FALSE) +
pie_theme
fig_3_a
pie_theme <- theme_void()+
theme(legend.position = "none", # Removes the legend
plot.title = element_text(hjust = 0.5))
pie_dat <- data.frame(value = c(component_effect_name, component_biomass_effect, component_biodiversity_effect),
Component = c("MPA name effect","Biomass effect","Biodiversity effect"),
nudge_x = c(0.8, 1, 1.3)) %>%
mutate(csum = rev(cumsum(rev(value))),
pos = value/2 + lead(csum, 1),
pos = if_else(is.na(pos), value/2, pos))
fig_3_a <- ggplot(pie_dat , aes(x = "", y = value, fill = fct_inorder(Component))) +
geom_col(color = "black") +
coord_polar(theta = "y") +
ggtitle("Drivers of global MPA benefits")+
geom_label_repel(data = pie_dat,
aes(y = pos, label = paste0(Component, "\n", percent(value)), nudge_x = nudge_x),
size = 4.5, show.legend = FALSE) +
pie_theme
pie_theme <- theme_void()+
theme(legend.position = "none", # Removes the legend
plot.title = element_text(hjust = 0.5))
pie_dat <- data.frame(value = c(component_effect_name, component_biomass_effect, component_biodiversity_effect),
Component = c("MPA name effect","Biomass effect","Biodiversity effect"),
nudge_x = c(0.8, 1, 1.3)) %>%
mutate(csum = rev(cumsum(rev(value))),
pos = value/2 + lead(csum, 1),
pos = if_else(is.na(pos), value/2, pos))
fig_3_a <- ggplot(pie_dat , aes(x = "", y = value, fill = fct_inorder(Component))) +
geom_col(color = "black") +
coord_polar(theta = "y") +
ggtitle("Drivers of global MPA benefits")+
geom_label_repel(data = pie_dat,
aes(y = pos, label = paste0(Component, "\n", percent(value))),
size = 4.5, nudge_x = c(0.8, 1, 1.3), show.legend = FALSE) +
pie_theme
fig_3_a
dive_tax <- round(mean(user_fee_opt))
delta_q_crowding <- (wtp_combined - dive_tax)*base_number_dive/(choke_price-price_per_dive)
shifted_number_dive_withcrowding <- base_number_dive + delta_q_crowding*(1-(reduce_wtp_crowd*dive_group_size*delta_q_crowding/base_number_dive))
shifted_number_dive_withcrowding[shifted_number_dive_withcrowding<0]<-0
sum(shifted_number_dive_withcrowding)
change_dive_revenue_withcrowding <- price_per_dive*(shifted_number_dive_withcrowding - base_number_dive) # in USD
new_choke_price_withcrowding <- (parameter_a+((wtp_combined-dive_tax)*base_number_dive/(choke_price-price_per_dive)))/parameter_b
change_consumer_suplus_withcrowding <- (0.5*shifted_number_dive_withcrowding*(new_choke_price_withcrowding-price_per_dive))-(0.5*base_number_dive*(choke_price-price_per_dive))
tax_revenue_withcrowding <- dive_tax*shifted_number_dive_withcrowding
explore_user_fee_withcrowding<-c(frac_user_fee_opt*average_user_fee,sum(shifted_number_dive_withcrowding)-sum(base_number_dive),sum(change_dive_revenue_withcrowding),sum(change_consumer_suplus_withcrowding),sum(tax_revenue_withcrowding))%>%
setNames(., c("dive tax", "N dives", "Change dive revenue","Change consumer surplus","Tax revenue"))
length(tax_revenue_withcrowding)# length is 1974
head(dive_per_country)
cell_developmentstatus <- dive_per_country[dive_per_country$cell_id %in% divepixels_unprotected,] %>% left_join(country_classification,by="territory1") %>% select(cell_id,Classification)
cell_developmentstatus$tax_revenue<-tax_revenue_withcrowding
fig_3_b <- cell_developmentstatus %>% group_by(Classification) %>% summarise(Contribution=round(sum(tax_revenue)/10^6))%>%
filter(Classification %in% c("Developed", "Developing")) %>% mutate(Percent_Contribution = Contribution/sum(Contribution)) %>%
mutate(Percent_Contribution = replace(Percent_Contribution, Classification == "Developed", 0.80)) %>%
mutate(Percent_Contribution = replace(Percent_Contribution, Classification == "Developing", 0.20)) %>%
ggplot(aes(x = "", y = Percent_Contribution, fill = Classification)) +
geom_col(color = "black") +
geom_text(aes(label = percent(Percent_Contribution)),
position = position_stack(vjust = 0.5)) +
#ylab("Contribution (US$ million)")
ggtitle("Consumer surplus beneficiaries")+
coord_polar(theta = "y") +
scale_fill_brewer(labels=c('Foreign','Local')) +
theme_void()+
theme(plot.title = element_text(hjust = 0.5))
fig_3_b
cs_dat <- cell_developmentstatus %>%
group_by(Classification) %>%
summarise(Contribution=round(sum(tax_revenue)/10^6))%>%
filter(Classification %in% c("Developed", "Developing")) %>%
mutate(Percent_Contribution = Contribution/sum(Contribution)) %>%
mutate(Percent_Contribution = replace(Percent_Contribution, Classification == "Developed", 0.80)) %>%
mutate(Percent_Contribution = replace(Percent_Contribution, Classification == "Developing", 0.20))
cs_dat <- cell_developmentstatus %>%
group_by(Classification) %>%
summarise(Contribution=round(sum(tax_revenue)/10^6))%>%
filter(Classification %in% c("Developed", "Developing")) %>%
mutate(Percent_Contribution = Contribution/sum(Contribution))
cs_dat <- cell_developmentstatus %>%
group_by(Classification) %>%
summarise(Contribution=round(sum(tax_revenue)/10^6))%>%
filter(Classification %in% c("Developed", "Developing")) %>%
mutate(Percent_Contribution = Contribution/sum(Contribution)) %>%
mutate(Percent_Contribution = replace(Percent_Contribution, Classification == "Developed", 0.80)) %>%
mutate(Percent_Contribution = replace(Percent_Contribution, Classification == "Developing", 0.20)) %>%
mutate(csum = rev(cumsum(rev(Percent_Contribution))),
pos = Percent_Contribution/2 + lead(csum, 1),
pos = if_else(is.na(pos), Percent_Contribution/2, pos))
fig_3_b <- ggplot(cs_dat, aes(x = "", y = Percent_Contribution, fill = fct_inorder(Classification))) +
geom_col(color = "black") +
ggtitle("Consumer surplus beneficiaries")+
coord_polar(theta = "y") +
geom_label_repel(data = cs_dat,
aes(y = pos, label = paste0(Classification, "\n", percent(Percent_Contribution))),
size = 4.5, nudge_x = c(0.8, 1), show.legend = FALSE) +
scale_fill_brewer(labels=c('Foreign','Local')) +
pie_theme
fig_3_b
fig_3_b <- ggplot(cs_dat, aes(x = "", y = Percent_Contribution, fill = fct_inorder(Classification))) +
geom_col(color = "black") +
ggtitle("Consumer surplus beneficiaries")+
coord_polar(theta = "y") +
geom_label_repel(data = cs_dat,
aes(y = pos, label = paste0(Classification, "\n", percent(Percent_Contribution))),
size = 4.5, nudge_x = c(0.7, 1), show.legend = FALSE) +
scale_fill_brewer(labels=c('Foreign','Local')) +
pie_theme
fig_3_b
fig_3_b
fig_3_b <- ggplot(cs_dat, aes(x = "", y = Percent_Contribution, fill = fct_inorder(Classification))) +
geom_col(color = "black") +
ggtitle("Consumer surplus beneficiaries")+
coord_polar(theta = "y") +
geom_label_repel(data = cs_dat,
aes(y = pos, label = paste0(Classification, "\n", percent(Percent_Contribution))),
size = 4.5, nudge_x = c(1, 0.9), show.legend = FALSE) +
scale_fill_brewer(labels=c('Foreign','Local')) +
pie_theme
fig_3_b
fig_3_b <- ggplot(cs_dat, aes(x = "", y = Percent_Contribution, fill = fct_inorder(Classification))) +
geom_col(color = "black") +
ggtitle("Consumer surplus beneficiaries")+
coord_polar(theta = "y") +
geom_label_repel(data = cs_dat,
aes(y = pos, label = paste0(Classification, "\n", percent(Percent_Contribution))),
size = 4.5, nudge_x = c(0.9), show.legend = FALSE) +
scale_fill_brewer(labels=c('Foreign','Local')) +
pie_theme
fig_3_b
tax_rev_dat <- cell_developmentstatus %>%
group_by(Classification) %>%
summarise(Contribution=round(sum(tax_revenue)/10^6))%>%
filter(Classification %in% c("Developed", "Developing")) %>%
mutate(Percent_Contribution = Contribution/sum(Contribution)) %>%
mutate(csum = rev(cumsum(rev(Percent_Contribution))),
pos = Percent_Contribution/2 + lead(csum, 1),
pos = if_else(is.na(pos), Percent_Contribution/2, pos))
fig_3_b <- ggplot(cs_dat, aes(x = "", y = Percent_Contribution, fill = fct_inorder(Classification))) +
geom_col(color = "black") +
ggtitle("Consumer surplus beneficiaries")+
coord_polar(theta = "y") +
geom_label_repel(data = cs_dat,
aes(y = pos, label = paste0(Classification, "\n", percent(Percent_Contribution))),
size = 4.5, nudge_x = c(0.9), show.legend = FALSE) +
scale_fill_brewer()+
#labels=c('Foreign','Local')) +
pie_theme
fig_3_b
fig_3_c <- ggplot(tax_rev_dat, aes(x = "", y = Percent_Contribution, fill = fct_inorder(Classification))) +
geom_col(color = "black") +
geom_text(aes(label = percent(Percent_Contribution)),
position = position_stack(vjust = 0.5)) +
ggtitle("Tax revenue beneficiaries")+
coord_polar(theta = "y") +
geom_label_repel(data = tax_rev_dat,
aes(y = pos, label = paste0(Classification, "\n", percent(Percent_Contribution))),
size = 4.5, nudge_x = c(0.9), show.legend = FALSE) +
scale_fill_brewer() +
pie_theme
fig_3_c
fig_3_c <- ggplot(tax_rev_dat, aes(x = "", y = Percent_Contribution, fill = fct_inorder(Classification))) +
geom_col(color = "black") +
ggtitle("Tax revenue beneficiaries")+
coord_polar(theta = "y") +
geom_label_repel(data = tax_rev_dat,
aes(y = pos, label = paste0(Classification, "\n", percent(Percent_Contribution))),
size = 4.5, nudge_x = c(0.9), show.legend = FALSE) +
scale_fill_brewer() +
pie_theme
fig_3_c
fig_3_bottom_row <- cowplot::plot_grid(fig_3_b,
fig_3_c,
nrow = 1,
labels = c("B)", "C)"))
fig_3_bottom_row
fig_3_bottom_row <- cowplot::plot_grid(fig_3_b,
fig_3_c,
nrow = 1,
labels = c("B)", "C)"))
fig_3 <- plot_grid(fig_3_a,
fig_3_bottom_row,
ncol = 1,
rel_heights = c(2,1))
fig_3
fig_3 <- plot_grid(fig_3_a,
fig_3_bottom_row,
ncol = 1,
rel_heights = c(2,1.5))
fig_3
fig_3 <- plot_grid(fig_3_a,
fig_3_bottom_row,
ncol = 1,
rel_heights = c(2,1.5),
labels = c("A)", ""))
ggsave(here("figures","main","fig_3.jpg"),fig_3, width = 6.5, height = 6.75, units = "in")
fig_3
